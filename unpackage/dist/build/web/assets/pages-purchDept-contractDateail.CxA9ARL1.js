import{r as a,a9 as l,c as e,w as t,q as s,o as u,b as c,d as i,t as n,e as d,f as o,F as f,W as r,a1 as v,k as _,h as p,s as m,i as h,p as b,m as y,X as g,ai as w,a3 as k}from"./index-dXG6ee6K.js";import{_ as A,o as D}from"./uni-app.es.DAsfJT2_.js";import{r as B,a as S}from"./requestFast.CgxnFt0n.js";const P=A({__name:"contractDateail",setup(A){const P=a(null),C=a(null),x=a(null),I=a(null),$=a(null),T=a(null),j=a(null),F=a(null),N=a(null),q=a(null),E=a(null),R=a(null),L=a(null),M=a(null),U=a(null),z=a(null),K=a(!1),O=a(!1),Q=a(!1),W=a(!1),X=a(""),G=a([]);D((async a=>{Y.value=a.fromNumber,await la(Y.value),await aa(Y.value)}));const H=a([]),J=a([]),V=a(null),Y=a(null),Z=()=>{w({data:Y.value,success(){_({icon:"none",title:"复制成功"})}})},aa=async a=>{const l=await B.post("/public/store/view/mod/findApprovalStatusByUserId",{fm:a});if(200===l.code){var e=l.data;O.value=e.isShowApproval,Q.value=e.isShowType,W.value=e.isShowStatus,X.value=e.approvalType,G.value=e.approvalStatus}},la=async a=>{const l=await B.post("/public/store/view/mod/contractOrderDetail",{keyword:a});200!==!l&&(J.value=l.submissionDateDetailList,V.value=S+"/"+l.filePath,P.value=l.partyAName,C.value=l.partyAAddress,x.value=l.partyATaxId,I.value=l.partyABank,$.value=l.partyAAccount,T.value=l.partyAPhone,j.value=l.partyARepresentative,F.value=l.partyAContractDate,N.value=l.partyBName,q.value=l.partyBAddress,E.value=l.partyBTaxId,R.value=l.partyBBank,L.value=l.partyBAccount,M.value=l.partyBPhone,U.value=l.partyBRepresentative,z.value=l.partyBContractDate,ua.value=l.auditStatus,K.value=l.isKeyProject,H.value.push({label:"库存数量",value:l.inventoryQuantity}),H.value.push({label:"购进政策",value:l.purchasePolicy}),H.value.push({label:"终端政策",value:l.terminalPolicy}),H.value.push({label:"业务奖励",value:l.businessReward}),H.value.push({label:"购进单位",value:l.purchaseUnit}),H.value.push({label:"返利单位",value:l.rebateMethod}),H.value.push({label:"承诺支付日期",value:l.commitmentPaymentDate}),H.value.push({label:"承诺支付截止日期",value:l.commitmentPaymentDateEnd}),H.value.push({label:"政策执行方式",value:l.policyExecutionMethod}),H.value.push({label:"政策类型",value:l.policyType}),H.value.push({label:"活动起始时间",value:l.activityStartDate}),H.value.push({label:"活动结束时间",value:l.activityEndDate}),H.value.push({label:"签约金额",value:l.totalPurchaseAmount}),H.value.push({label:"合同编号",value:Y.value}))},ea=a(!1),ta=a=>/\d{4}-\d{2}-\d{2}/.test(a)||/至/.test(a),sa=a=>/¥|元/.test(a),ua=a(null);l((()=>"未审核"===ua.value)),l((()=>"已审核"===ua.value)),l((()=>"已作废"!==ua.value&&"未审核"!==ua.value));const ca=async()=>{const a=[];for(var l=0;l<G.value.length;l++){var e=G.value[l];"未审核"!==e?a.push(e.substring(1,3)):a.push("弃审")}Q.value&&a.push("重点合同"===X.value?"标记为重点合同":"标记为普通合同"),0!==a.length?p({itemList:a,success:l=>{const e=a[l.tapIndex];"审核"===e?ia("已审核"):"弃审"===e?ia("未审核"):"作废"===e?ia("已作废"):"标记为普通合同"===e?ia("普通合同"):"标记为重点合同"===e&&ia("重点合同")},fail:()=>{}}):_({title:"当前状态不可操作",icon:"none"})},ia=a=>{var l="";l="普通合同"===a?"转普通合同":"重点合同"===a?"转重点合同":a,m({title:`确认${a}`,content:`您确定要将订单标记为【${a}】吗？`,success:async e=>{if(e.confirm){ua.value=a;const e=await B.post("/public/store/view/mod/editAuditStatus",{fm:Y.value,auditStatus:a});console.log(e),200===e.code&&await la(Y.value),_({title:200===e.code?`${l}成功`:`${l}失败`,icon:200===e.code?"success":"fail"})}}})};return(a,l)=>{const _=h,p=b,m=k,w=y,A=s;return u(),e(A,{"scroll-y":"",class:"container"},{default:t((()=>[c(_,{class:"section"},{default:t((()=>[c(_,{class:"section-title"},{default:t((()=>[i("甲乙双方信息")])),_:1}),c(_,{class:"parties-container"},{default:t((()=>[c(_,{class:"party-info"},{default:t((()=>[c(_,{class:"sub-section-title"},{default:t((()=>[i("甲方信息")])),_:1}),c(_,{class:"info-item"},{default:t((()=>[c(p,{class:"label"},{default:t((()=>[i("公司：")])),_:1}),i(n(P.value),1)])),_:1}),c(_,{class:"info-item"},{default:t((()=>[c(p,{class:"label"},{default:t((()=>[i("地址：")])),_:1}),i(n(C.value),1)])),_:1}),c(_,{class:"info-item"},{default:t((()=>[c(p,{class:"label"},{default:t((()=>[i("账户：")])),_:1}),c(p,{class:"highlight-number"},{default:t((()=>[i(n($.value),1)])),_:1})])),_:1}),c(_,{class:"info-item"},{default:t((()=>[c(p,{class:"label"},{default:t((()=>[i("开户行：")])),_:1}),i(n(I.value),1)])),_:1}),c(_,{class:"info-item"},{default:t((()=>[c(p,{class:"label"},{default:t((()=>[i("税号：")])),_:1}),i(n(x.value),1)])),_:1}),c(_,{class:"info-item"},{default:t((()=>[c(p,{class:"label"},{default:t((()=>[i("电话：")])),_:1}),c(p,{class:"highlight-number"},{default:t((()=>[i(n(T.value),1)])),_:1})])),_:1}),c(_,{class:"info-item"},{default:t((()=>[c(p,{class:"label"},{default:t((()=>[i("签约代表：")])),_:1}),i(n(j.value),1)])),_:1}),c(_,{class:"info-item"},{default:t((()=>[c(p,{class:"label"},{default:t((()=>[i("签约时间：")])),_:1}),i(n(F.value),1)])),_:1})])),_:1}),c(_,{class:"party-info"},{default:t((()=>[c(_,{class:"sub-section-title"},{default:t((()=>[i("乙方信息")])),_:1}),c(_,{class:"info-item"},{default:t((()=>[c(p,{class:"label"},{default:t((()=>[i("公司：")])),_:1}),i(n(N.value),1)])),_:1}),c(_,{class:"info-item"},{default:t((()=>[c(p,{class:"label"},{default:t((()=>[i("地址：")])),_:1}),i(n(q.value),1)])),_:1}),c(_,{class:"info-item"},{default:t((()=>[c(p,{class:"label"},{default:t((()=>[i("账户：")])),_:1}),c(p,{class:"highlight-number"},{default:t((()=>[i(n(L.value),1)])),_:1})])),_:1}),c(_,{class:"info-item"},{default:t((()=>[c(p,{class:"label"},{default:t((()=>[i("开户行：")])),_:1}),i(n(R.value),1)])),_:1}),c(_,{class:"info-item"},{default:t((()=>[c(p,{class:"label"},{default:t((()=>[i("税号：")])),_:1}),i(n(E.value),1)])),_:1}),c(_,{class:"info-item"},{default:t((()=>[c(p,{class:"label"},{default:t((()=>[i("电话：")])),_:1}),c(p,{class:"highlight-number"},{default:t((()=>[i(n(M.value),1)])),_:1})])),_:1}),c(_,{class:"info-item"},{default:t((()=>[c(p,{class:"label"},{default:t((()=>[i("签约代表：")])),_:1}),i(n(U.value),1)])),_:1}),c(_,{class:"info-item"},{default:t((()=>[c(p,{class:"label"},{default:t((()=>[i("签约时间：")])),_:1}),i(n(z.value),1)])),_:1})])),_:1})])),_:1})])),_:1}),c(_,{class:"section"},{default:t((()=>[c(_,{class:"section-title"},{default:t((()=>[i("合同概要")])),_:1}),c(_,{class:"info-grid"},{default:t((()=>[(u(!0),d(f,null,o(H.value,((a,l)=>(u(),e(_,{key:l,class:"info-item"},{default:t((()=>{return[c(p,{class:"label"},{default:t((()=>[i(n(a.label)+"：",1)])),_:2},1024),c(p,{class:g(["value",{"highlight-number":(l=a.value,/^\d+$/.test(l)||/^\d+盒$/.test(l)||/^\d+片$/.test(l)),"highlight-date":ta(a.value),"highlight-money":sa(a.value)}])},{default:t((()=>[i(n(a.value),1)])),_:2},1032,["class"]),"合同编号"===a.label?(u(),e(m,{key:0,size:"mini",onClick:Z},{default:t((()=>[i("复制")])),_:1})):r("",!0)];var l})),_:2},1024)))),128))])),_:1})])),_:1}),c(_,{class:"section"},{default:t((()=>[c(_,{class:"section-title"},{default:t((()=>[i("订单明细")])),_:1}),(u(!0),d(f,null,o(J.value,((a,l)=>(u(),e(_,{key:l,class:"order-card"},{default:t((()=>[c(_,{class:"order-row"},{default:t((()=>[c(p,{class:"label"},{default:t((()=>[i("药品ID：")])),_:1}),c(p,{class:"highlight-id"},{default:t((()=>[i(n(a.productId),1)])),_:2},1024)])),_:2},1024),c(_,{class:"order-row"},{default:t((()=>[c(p,{class:"label"},{default:t((()=>[i("药品名称：")])),_:1}),i(n(a.drugName),1)])),_:2},1024),c(_,{class:"order-row"},{default:t((()=>[c(p,{class:"label"},{default:t((()=>[i("生产厂家：")])),_:1}),i(n(a.manufacturer),1)])),_:2},1024),c(_,{class:"order-row"},{default:t((()=>[c(p,{class:"label"},{default:t((()=>[i("规格：")])),_:1}),i(n(a.specification),1)])),_:2},1024),c(_,{class:"order-row"},{default:t((()=>[c(p,{class:"label"},{default:t((()=>[i("单位：")])),_:1}),i(n(a.unit),1)])),_:2},1024),c(_,{class:"order-row"},{default:t((()=>[c(p,{class:"label"},{default:t((()=>[i("数量：")])),_:1}),c(p,{class:"highlight-number"},{default:t((()=>[i(n(a.quantity),1)])),_:2},1024)])),_:2},1024),c(_,{class:"order-row"},{default:t((()=>[c(p,{class:"label"},{default:t((()=>[i("补差：")])),_:1}),c(p,{class:"highlight-money"},{default:t((()=>[i(n(a.supplementDiff),1)])),_:2},1024)])),_:2},1024),c(_,{class:"order-row"},{default:t((()=>[c(p,{class:"label"},{default:t((()=>[i("备注：")])),_:1}),i(n(a.remarks),1)])),_:2},1024)])),_:2},1024)))),128))])),_:1}),c(_,{class:"footer-btns"},{default:t((()=>[O.value?(u(),e(_,{key:0,class:"audit-btn",onClick:ca},{default:t((()=>[c(p,null,{default:t((()=>[i("审核订单")])),_:1})])),_:1})):r("",!0),c(_,{class:"attachment-btn",onClick:l[0]||(l[0]=a=>ea.value=!0)},{default:t((()=>[c(p,null,{default:t((()=>[i("查看合同附件")])),_:1}),c(w,{src:"/static/icon-preview.png",mode:"aspectFit",class:"preview-icon"})])),_:1})])),_:1}),ea.value?(u(),e(_,{key:0,class:"attachment-mask",onClick:l[3]||(l[3]=a=>ea.value=!1)},{default:t((()=>[c(_,{class:"attachment-content",onClick:l[2]||(l[2]=v((()=>{}),["stop"]))},{default:t((()=>[c(w,{src:V.value,mode:"widthFix",class:"attachment-image"},null,8,["src"]),c(_,{class:"close-btn",onClick:l[1]||(l[1]=a=>ea.value=!1)},{default:t((()=>[i("×")])),_:1})])),_:1})])),_:1})):r("",!0)])),_:1})}}},[["__scopeId","data-v-218725da"]]);export{P as default};
