import{r as a,J as t,a as e,c as s,w as l,i as r,o as u,b as c,d as o,W as n,e as d,f as i,F as f,p,a3 as m,t as _,X as v,g as b}from"./index-dXG6ee6K.js";import{_ as y}from"./uni-search-bar.DEcv9Eye.js";import{_ as h,a as k,r as w}from"./uni-app.es.DAsfJT2_.js";import{r as g}from"./requestFast.CgxnFt0n.js";import"./uni-icons.0JbcxFJl.js";const x=h({__name:"contractQuery",setup(h){const x=a([]),j=a(null),L=a("输入合同编号查询"),C=a(!1),B=a(0),N=a(!1);k((async()=>{await P(),await O()}));const O=async()=>{const a=await g.get("/public/store/view/mod/contractOrderListByUserId");200===a.code&&(x.value=a.data)},P=async()=>{if(t("token")){const a=await g.post("/public/store/view/mod/checkToken");200===a.code&&(L.value="输入采购员姓名查询",C.value=!0,B.value=a.Level,N.value=a.isPrint)}},S=async()=>{const a=await g.post(C.value?"/public/store/view/mod/contractOrderList":"/public/store/view/mod/noTokenContractOrderList",{keyword:j.value});200===a.code&&(x.value=a.data),500===a.code&&(x.value=[])};function T(a){switch(a){case"已审核":case"下载":return"status-approved";case"重点":return"status-pending";case"未审核":return"status-rejected";case"已作废":return"status-unsubmitted";default:return""}}return(a,t)=>{const h=p,k=w(e("uni-search-bar"),y),g=r,C=m;return u(),s(g,{class:"page"},{default:l((()=>[c(g,{class:"container"},{default:l((()=>[c(g,{class:"header"},{default:l((()=>[c(h,{class:"title"},{default:l((()=>[o("合同查询")])),_:1}),1!==B.value||N.value?(u(),s(g,{key:0,class:"context-search"},{default:l((()=>[c(g,null,{default:l((()=>[c(k,{class:"uni-mt-10",radius:"100",placeholder:L.value,clearButton:"none",cancelButton:"none",modelValue:j.value,"onUpdate:modelValue":t[0]||(t[0]=a=>j.value=a)},null,8,["placeholder","modelValue"])])),_:1}),c(g,{style:{display:"grid","place-items":"center"}},{default:l((()=>[c(C,{size:"mini",style:{"border-radius":"35rpx",padding:"5rpx 36rpx","background-color":"#007aff",color:"white","font-size":"25rpx",border:"none"},onClick:S},{default:l((()=>[o("搜索")])),_:1})])),_:1})])),_:1})):n("",!0)])),_:1}),c(g,{class:"contract-list"},{default:l((()=>[(u(!0),d(f,null,i(x.value,((a,t)=>(u(),s(g,{key:t,class:"contract-item",onClick:t=>{return e=a.formNumber,void b({url:"/pages/purchDept/contractDateail?fromNumber="+e});var e}},{default:l((()=>[c(g,{class:"contract-details"},{default:l((()=>[c(h,{class:"contract-name"},{default:l((()=>[o(_(a.partAName),1)])),_:2},1024),c(h,{class:"contract-date"},{default:l((()=>[o(_(a.submitTime),1)])),_:2},1024)])),_:2},1024),c(g,{class:"contract-amount"},{default:l((()=>[c(h,{class:"amount"},{default:l((()=>{return[o(_((t=a.totalPurchaseAmount,`¥${t.toLocaleString()}`)),1)];var t})),_:2},1024)])),_:2},1024),c(g,{class:"purchaser"},{default:l((()=>[c(h,{class:"purchaser-label"},{default:l((()=>[o("采购员: ")])),_:1}),c(h,{class:"purchaser-name"},{default:l((()=>[o(_(a.submitter),1)])),_:2},1024)])),_:2},1024),c(g,{class:"contract-footer"},{default:l((()=>[a.isKeyProject?(u(),s(h,{key:0,class:v(["audit-status",T("重点")])},{default:l((()=>[o(" 重点合同 ")])),_:1},8,["class"])):n("",!0),c(h,{class:v(["audit-status",T(a.auditStatus)]),style:{"margin-left":"25rpx"}},{default:l((()=>[o(_(a.auditStatus),1)])),_:2},1032,["class"]),c(h,{class:v(["audit-status",T("下载")]),style:{"margin-left":"25rpx"}},{default:l((()=>[o(" 下载 ")])),_:1},8,["class"])])),_:2},1024)])),_:2},1032,["onClick"])))),128)),0===x.value.length?(u(),s(g,{key:0},{default:l((()=>[c(h,null,{default:l((()=>[o("暂无数据")])),_:1})])),_:1})):n("",!0)])),_:1})])),_:1})])),_:1})}}},[["__scopeId","data-v-b7300c22"]]);export{x as default};
